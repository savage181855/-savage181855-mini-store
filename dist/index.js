function t(t={}){const e=Page;Page=function(n){const o={...t,...n,onLoad(){n.useStoreRef&&n.useStoreRef(this,n.mapState,n.mapActions),t?.onLoad?.call(this,...arguments),n?.onLoad?.call(this,...arguments)}};["onShow","onReady","onHide","onUnload","onPullDownRefresh","onReachBottom","onPageScroll","onResize","onTabItemTap"].forEach((e=>{o[e]=function(){t?.[e]?.call(this,...arguments),n?.[e]?.call(this,...arguments)}})),e(o)}}function e(t={}){const e=Component;Component=function(n){const o={...t,...n,lifetimes:{attached(){n.useStoreRef&&n.useStoreRef(this,n.mapState,n.mapActions),n?.lifetimes?.attached?.call(this,...arguments),t?.lifetimes?.attached?.call(this,...arguments)},detached(){n.useStoreRef&&this.data.store.cancelUse(this),n?.lifetimes.detached?.call(this,...arguments),t?.lifetimes?.detached?.call(this,...arguments)}}};e(o)}}function n(t,e){if(t===e)return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;const o=/Number|Boolean|String|Null|Undefined|Symbol|Function|RegExp|Date/,c=Object.prototype.toString.call(t).slice(8,-1),s=Object.prototype.toString.call(e).slice(8,-1);if("Object"!==c&&"Array"!==c&&"Object"!==s&&"Object"!==s&&o.exec(c)[0]===o.exec(s)[0]&&c===s)return!0;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let o of Object.keys(t)){const c=n(t[o],e[o]);if(!c)return c}return!0}function o(t){if(!t||"object"!=typeof t)return t;if(/Number|Boolean|String|Null|Undefined|Symbol|Function|RegExp|Date/.test(Object.prototype.toString.call(t)))return t;const e="Array"===t.constructor?[]:{};for(let n in t)e[n]="object"==typeof t[n]?o(t[n]):t[n];return e}function c(t,e){return!n(t,e)}const s={subscribeList:{},pubAndNoSub:{},subscribe(t,e){this.pubAndNoSub[t]&&(e(this.pubAndNoSub[t]),Reflect.deleteProperty(this.pubAndNoSub,t)),this.subscribeList[t]?.push(e)||(this.subscribeList[t]=[e])},publish(t,e){const n=this.subscribeList[t];n&&0!==n.length?n.forEach((t=>t(e))):this.pubAndNoSub[t]=e},remove(t,e){const n=this.subscribeList[t];n&&0!==n.length&&(e?n.forEach(((n,o)=>{n===e&&this.subscribeList[t].splice(o,1)})):this.subscribeList[t]=[])}};function i(t){const e=o(s);for(let n in s)t[n]=e[n]}function r(t){const e={...t.state,...t.actions,patch(t){if("object"==typeof t)for(let e in t)r[e]=t[e];"function"==typeof t&&t(r)},cancelUse(t){t.onUnload()}};i(e);const n={get:function(t,e,n){const o=Reflect.get(t,e,n);return null!==(c=o)&&"object"==typeof c?s(o):o;var c},set:function(t,e,n,s){const i=o(r),u=Reflect.set(t,e,n,s);return Reflect.ownKeys(r.subscribeList).forEach((t=>{c(i[t],r[t])&&r.subscribeList[t].forEach((e=>e(r[t])))})),u}};function s(t){return function(t,e){return new Proxy(t,e)}(t,n)}let r=null;return r=s(e),function(t,e=[],n=[]){n.forEach((e=>t[e]=r[e].bind(r))),t.data.store=r;const o={};e.forEach((t=>o[t]=r[t])),t.setData(o);const c={};e.forEach((e=>{c[e]=n=>{t.setData({[e]:n})},r.subscribe(e,c[e])}));const s=t.onUnload||function(){};return t.onUnload=function(){s(),Reflect.ownKeys(c).forEach((t=>r.remove(t,c[t])))},r}}const u=function(){const t={};return i(t),{passValue(e,n){t.publish(e,n)},receiveValue(e,n,o=(t=>t),c=!0){let s;c?(e.setData({[n]:""}),s=t=>{e.setData({[n]:o(t)})}):s=t=>{o(t)},t.subscribe(n,s)},cancelReceive(e){t.remove(e)}}}(),{passValue:a,receiveValue:l,cancelReceive:f}=u;export{f as cancelReceive,r as defineStore,a as passValue,e as proxyComponent,t as proxyPage,l as receiveValue};
